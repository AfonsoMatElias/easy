<div style="flex: 1; display: flex;">
    <div class="editor" e-class="{ 'show-result' : showResult }">
        <div class="main">
            <div class="editor-aside editor-html">
                <div class="top">
                    <div>
                        <span class="fa fa-eye" title="Click to see whole the HTML code"></span>
                        <label> Live Editor </label>
                    </div>
                </div>
                <div class="screen editor-screen" e-ignore>
                    <div class="screen-view html hljs nice-scroll" tabindex="-1" spellcheck="false"></div>
                    <div class="screen-write nice-scroll" tabindex="-1" spellcheck="false" contenteditable="true"></div>
                </div>
                <div class="extra-area">
                    <span class="info">
                        <span>
                            <span class="fa fa-info-circle"></span>
                            <span class="text"> ' Ctrl + Enter ' to compile your code. </span>
                        </span>
                    </span>
                </div>
            </div>
            <span class="resizable"></span>
            <div class="editor-aside editor-result" e-ignore>
                <div class="top">
                    <div>
                        <label> Result </label>
                    </div>
                </div>
                <div class="screen">
                    <!-- <object type="text/html" style="position: absolute; left: 0; top: 0; right: 0; bottom: 0; width: 100%;height: 100%;"></object> -->
                    <iframe frameBorder="0"
                        style="position: absolute; left: 0; top: 0; right: 0; bottom: 0; width: 100%;height: 100%;"></iframe>
                </div>
                <div class="extra-area nice-scroll">
                    <span class="info console">
                        <span>
                            <span class="fa fa-check-circle"></span>
                            <span class="text"> Console </span>
                        </span>
                    </span>
                    <span class="message"></span>
                </div>
            </div>
        </div>
        <div class="extra">
            <div class="modal hide-it">
                <div class="head">
                    <div class="name">
                        <h4> {{ name }} Example</h4>
                    </div>
                    <div class="action">
                        <span class="fa fa-remove" on:click="(function(){
                            event.base.aboveMe('.modal').classList.add('hide-it');
                        })()"></span>
                    </div>
                </div>
                <div class="body nice-scroll" tabindex="-1"></div>
                <span class="popup hide-it" e-anm="up">
                    <span> </span>
                </span>
            </div>
            <div class="alternator">
                <button on:click="$scope.sMenuClosed = false">Tutorial</button>
                <button on:click="showResult = false" e-class="{ 'active-side' : !showResult }">Code</button>
                <button on:click="runCodeShowResult" e-class="{ 'active-side' : showResult }">Result</button>
            </div>
        </div>
    </div>
</div>
<script>
    var $comp = this;
    var $easy = this.Easy;
    var id = 'live-' + $easy.code();
    var watch, evtResize, MOBILE_SIZE = 645;
    var $editorInstance;
    this.created = function (element) {
        element.id = id;
    }
    this.mounted = function (element) {
        var editor = element.children[0];
        var $classes = editor.classList;
        var exec = $easy.lazy(function (width) {
            var has = $classes.contains('mobile');
            if (MOBILE_SIZE >= width) {
                if (!has) $classes.add('mobile');
            } else {
                if (has) $classes.remove('mobile');
            }
        }, 250);

        evtResize = window.listen('resize', function (evt) {
            exec(element.clientWidth);
        });

        exec(element.clientWidth);
    }
    this.loaded = function (element) {
        // Editor config 
        function Editor(selector, options) {
            var editor = (selector instanceof Element) ? selector :
                element.querySelector(selector);

            if (!editor) {
                return console.error('[Editor]: Editor element not found!');
            }

            var instance = this;

            var eye = editor.querySelector('.fa-eye');
            var modal = editor.querySelector('.modal');
            var modalPopup = editor.querySelector('.modal .popup');
            var view = editor.querySelector('.screen-view');
            var write = editor.querySelector('.screen-write');
            var result = editor.querySelector('.editor-result .screen').children[0];

            if (!view || !write) {
                console.error('[Editor]: Missing screens to be added: div.screen-view or div.screen-write.');
                return;
            }

            // Configuring the instance var
            instance.el = editor;
            instance.result = result;
            instance.screen = write;
            instance.content = '';
            options = options || {};

            for (const key in options)
                instance[key] = options[key];

            // vars 
            var $console = instance.el.node('.console');
            var consoleIcon = $console.node('.fa');
            var consoleSection = $console.parentNode;
            var messageContainer = consoleSection.node('.message');
            var icons = {
                warn: 'fa-warning',
                fine: 'fa-check-circle',
                error: 'fa-times-circle'
            }

            // Confifuring the instance functions
            instance.console = {
                add: function (obj) {
                    messageContainer.innerHTML += '<p class="line fa ' + obj.type + '">' + obj.msg + '</p>';
                    setConsoleIcon(icons[obj.type]);
                },
                clear: function () {
                    messageContainer.innerHTML = '';
                    setConsoleIcon(icons.fine);
                }
            };

            if (instance.type) {
                editor.children[0].classList.add(instance.type);
            }

            if (instance.resizable) {
                var resizable = instance.el.node('.resizable');
                resizable.style.cursor = 'n-resize';

                function dragElement(element, first, second, dir) {
                    var md; // remember mouse down info
                    element.onmousedown = onMouseDown;

                    function onMouseDown(e) {
                        md = {
                            e: e,
                            offsetLeft: element.offsetLeft,
                            offsetTop: element.offsetTop,
                            firstWidth: first.offsetWidth,
                            secondWidth: second.offsetWidth,
                            firstHeight: first.offsetHeight - 2,
                            secondHeight: second.offsetHeight - 2
                        };
                        document.onmousemove = onMouseMove;
                        document.onmouseup = function () {
                            document.onmouseup = document.onmousemove = null;
                        }
                    }

                    function onMouseMove(e) {
                        var delta = {
                            x: e.clientX - md.e.x,
                            y: e.clientY - md.e.y
                        };

                        // prevent negative-sized elements
                        delta.y = Math.min(Math.max(delta.y, -md.firstHeight), md.secondHeight);

                        if (dir === 'y') {
                            element.style.height = '2px';
                            element.style.top = md.offsetTop + delta.y + "px";
                            first.style.height = (md.firstHeight + delta.y) + "px";
                            second.style.height = (md.secondHeight - delta.y) + "px";
                            element.style.flex = first.style.flex = second.style.flex = 'unset';
                        }
                    }
                }

                dragElement(resizable,
                    instance.el.node('.editor-aside.editor-html'),
                    instance.el.node('.editor-aside.editor-result'), instance.resizable);
            }

            // events
            // UI Updater
            watch = $easy.watch('content', function (v) {
                updateView();
            }, $comp.scope);

            write.onkeyup = write.oninput = function () {
                updateView();
            }

            write.onkeydown = function (evt) {
                if (evt.keyCode === 9) {
                    evt.preventDefault();
                    // Adding tab
                    var range = window.getSelection().getRangeAt(0);
                    var tabNode = document.createTextNode(Editor.tabs());
                    range.insertNode(tabNode);
                    range.setStartAfter(tabNode);
                    range.setEndAfter(tabNode);
                }

                if (evt.ctrlKey && evt.keyCode === 13) {
                    runCode();
                }
            }

            write.onscroll = function () {
                view.scrollTop = write.scrollTop;
                view.scrollLeft = write.scrollLeft;
            }

            eye.onclick = function () {
                var content = createTemplate(instance.screen.innerText);
                var view = modal.node('.body');
                view.innerText = content;
                hljs.highlightBlock(view);
                modal.classList.remove('hide-it');
            }

            modal.node('.body').ondblclick = function (evt) {
                copyTextToClipboard(evt.target.innerText);
            }

            $console.onclick = function (evt) {
                var $class = 'open-extra',
                    fun = 'add';
                fun = consoleSection.classList.contains($class) ? 'remove' : 'add';
                consoleSection.classList[fun]($class);
            }

            // Last executions
            if (instance.content) {
                write.innerText = instance.content;
                updateView();
                if (instance.run)
                    runCode();
            }

            // functions
            function updateView() {
                view.innerHTML = write.innerHTML;
                hljs.highlightBlock(view);
            }

            function runCode() {
                // Clear the console
                setConsoleIcon(icons.fine);
                instance.console.clear();

                // Execute your code...
                var content = createTemplate(instance.screen.innerText,
                    Editor.tabs() + '\n<script> ' +
                    '\nvar editor = parent.document.querySelector(\'#' + id + '\').$editor;\n' +
                    codeToStr(function () {
                        var $$refs = {
                            log: console.log.bind(console),
                            warn: console.warn.bind(console),
                            error: console.error.bind(console)
                        };

                        if (typeof $$refs.keys === 'function') {
                            $$refs.keys(function (key, v) {
                                console[key] = function (info, value) {
                                    var $value = '';
                                    if (!value) {
                                        $value = info;
                                    } else {
                                        if (typeof value === 'string')
                                            $value = value;
                                        else
                                            $value = JSON.stringify(value);
                                    }

                                    editor.console.add({
                                        type: key === 'log' ? 'fine' : key,
                                        msg: $value
                                    });
                                }
                            });
                        }
                    }) +
                    '<\/script>'
                );

                // Filling the screen
                var idoc = result.contentWindow.document;
                idoc.open();
                idoc.write(content);
                idoc.close();
            }

            function setConsoleIcon(name) {
                for (var key in icons) {
                    var v = icons[key];
                    consoleIcon.classList.remove(v);
                }
                consoleIcon.classList.add(name);
            }

            function createTemplate(content, extra) {
                extra = extra || '';
                var str = '<html lang="en">' +
                    '\n<head>' +
                    Editor.tabs() + '\n<meta charset="UTF-8">' +
                    Editor.tabs() + '\n<title>Live Editor page<\/title>' +
                    Editor.tabs() + '\n<script src="assets/js/easy.js"><\/script>' +
                    Editor.tabs() +
                    '\n<style> * html,body { padding:0; } { font-family: Arial, Helvetica, sans-serif; } ' +
                    'input, button { border: 1px solid lightgray; border-radius: 3px; } button { padding: 3px 10px; } </style>' +
                    extra +
                    '\n<\/head>' +
                    '\n<body>\n' +
                    content +
                    '\n<\/body>' +
                    '\n<\/html>';

                return str;
            }

            function codeToStr(c) {
                var t = (c + '');
                var len = 'function(){'.length;
                len = t.startsWith('function () {') ? len + 2 : len;
                t = t.substr(len);
                return t.substr(0, t.length - 1);
            }

            function copyTextToClipboard(text) {
                // Messages
                var successful = 'Text successfully copied to clipboard';
                var fail = 'Fail to copy the text, you need to copy it manually';

                function fallbackCopyTextToClipboard(text) {
                    var textArea = document.createElement("textarea");
                    textArea.value = text;
                    // Avoid scrolling to bottom
                    textArea.style.display = "none";

                    document.body.appendChild(textArea);
                    textArea.focus();
                    textArea.select();

                    try {
                        if (!document.execCommand('copy')) throw ({});
                        showPopup(successful);
                    } catch (err) {
                        showPopup(fail);
                    }

                    document.body.removeChild(textArea);
                }

                if (!navigator.clipboard) {
                    fallbackCopyTextToClipboard(text);
                    return;
                }

                navigator.clipboard.writeText(text).then(function () {
                    showPopup(successful);
                }, function (err) {
                    showPopup(fail);
                });
            }

            function showPopup(msg) {
                modalPopup.children[0].innerText = msg;
                modalPopup.classList.remove('hide-it');
                var t = setTimeout(function () {
                    modalPopup.classList.add('hide-it');
                }, 3000);
            }

            instance.runCode = runCode;
            return instance;
        }

        Editor.tabs = function (n) {
            var tab = '\u00a0\u00a0',
                str = tab;
            for (let i = 1; i <= n || 0; i++)
                str += tab;
            return str;
        }

        // Editor initialization
        $editorInstance = element.$editor = new Editor(element,
            this.Easy.extend.obj(this.scope, {
                run: true
            }));

    }
    this.destroyed = function (element) {
        if (watch) watch.destroy();
        if (evtResize) window.removeEventListener(evtResize.event, evtResize.callback, false);
    }

    this.export({
        showResult: false,
        runCodeShowResult: function () {
            if ($editorInstance) {
                $editorInstance.runCode();
                $comp.scope.showResult = true;
            }
        }
    });
</script>
<style scoped>
    /* Editor style */
    .editor {
        flex: 1;
        display: flex;
        flex-flow: column;
        height: 420px;
        border-radius: 6px;
        background-color: var(--color-bg-lighter);
        border: 1px solid var(--color-editor-border);
        position: relative;
    }

    .editor .main {
        display: flex;
        flex-flow: row;
        flex: 1;
    }

    .editor .editor-html {
        flex: 2;
        border: 1px solid var(--color-editor-border);
        font-size: 10.5pt;
        min-height: 75px;
    }

    .editor .editor-result {
        border: 1px solid var(--color-editor-border);
        flex: 1.5;
        font-size: 11pt;
        min-height: 75px;
    }

    .editor .editor-result .screen {
        background-color: var(--color-editor-result-screen);
    }

    .editor-aside {
        display: flex;
        flex-flow: column;
    }

    .editor-aside .screen {
        flex: 1;
        overflow-y: auto;
        outline: none;
    }

    .editor-aside .screen *,
    .editor-aside .extra-area .text,
    .editor-aside .extra-area .message * {
        font-family: Consolas, 'Courier New', monospace;
    }

    .editor-aside .editor-screen {
        border-left: 20px solid var(--color-light-grey);
        display: flex;
        position: relative;
    }

    .editor-aside .editor-screen>div {
        white-space: nowrap;
        position: absolute;
        overflow: auto;
        padding: 6px;
        bottom: 0;
        right: 0;
        left: 0;
        top: 0;
    }

    .editor-aside .editor-screen .screen-write {
        color: transparent;
        caret-color: var(--color-editor-caret) !important;
    }

    .editor-aside .editor-screen>div:nth-child(1) {
        background-color: var(--color-editor-screen);
    }

    .editor-aside .editor-screen [contenteditable] {
        outline: none;
    }

    .editor-aside .top {
        height: 35px;
        font-size: 10pt;
        color: var(--color-text);
        position: relative;
        border-bottom: 0.1px solid var(--color-border);
    }

    .editor-aside .top>div {
        top: 50%;
        left: 8px;
        position: absolute;
        transform: translateY(-50%);
    }

    .editor-aside .top .fa {
        cursor: pointer;
        padding: 0 12px;
    }

    .editor-aside .top label {
        font-weight: 500;
    }

    .editor-result .screen {
        position: relative;
    }

    .editor-aside .extra-area {
        height: 40px;
        background-color: var(--color-editor-border);
        font-size: 11pt;
        color: var(--color-text);
        transition: height .2s;
        overflow: hidden;
    }

    .editor .open-extra {
        height: 120px;
        overflow-y: auto;
    }

    .editor .extra-area .info {
        padding: 0 10px;
        display: block;
        height: 40px;
    }

    .editor .extra-area .info {
        position: relative;
    }

    .editor .extra-area .info>span {
        top: 50%;
        position: absolute;
        transform: translateY(-50%);
    }

    .editor .extra-area .info>span .fa {
        margin: 0 10px;
    }

    .editor .extra-area .console {
        cursor: pointer;
    }

    .editor .console .fa-check-circle {
        color: var(--color-green) !important;
    }

    .editor .console .fa-times-circle {
        color: var(--color-red) !important;
    }

    .editor .console .fa-warning {
        color: var(--color-yellow) !important;
    }

    .editor .extra-area .message {
        display: block;
        padding: 5px;
        word-wrap: anywhere;
    }

    .editor .extra-area .message .line {
        margin: 4px 0;
    }

    .editor .extra-area .message .error {
        color: var(--color-red);
    }

    .editor .extra-area .message .warn {
        color: var(--color-yellow);
    }

    /* Editor Modal */
    .editor .modal {
        background-color: var(--color-bg-lighter);
        box-shadow: var(--set-shadow);
        border-radius: 6px;
        position: absolute;
        width: 80%;
        height: 500px;
        top: -10%;
        left: 50%;
        transform: translateX(-50%);
        z-index: 100;
        display: flex;
        flex-flow: column;
        overflow: hidden;
    }

    .editor .modal .head {
        display: flex;
        min-height: 50px;
        height: 50px;
        padding: 0 10px;
    }

    .editor .modal .head .name {
        flex: 1;
        display: flex;
    }

    .editor .modal .head .name h4 {
        margin: auto auto auto 0;
    }

    .editor .modal .head .action {
        width: 100px;
        display: flex;
    }

    .editor .modal .head .action .fa {
        font-size: 9pt;
        width: 18px;
        height: 18px;
        background-color: var(--color-red);
        position: relative;
        border-radius: 50%;
        box-shadow: var(--set-shadow);
        color: transparent;
        margin: auto 0px auto auto;
        cursor: pointer;
    }

    .editor .modal .head .action .fa:hover {
        transition: color .2s;
        color: var(--color-white-text);
    }

    .editor .modal .head .action .fa::before {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
    }

    .editor .modal .body {
        background-color: var(--color-bg-lighter);
        padding: 10px;
        overflow: auto;
        flex: 1;
    }

    .editor .modal .body * {
        font-family: Consolas, 'Courier New', monospace;
    }

    .resizable {
        flex: 0.01;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        background-color: var(--color-border);
    }

    /* Editor */

    /* Mobile type */
    .editor.mobile>.main>span,
    .editor.mobile .editor-result {
        display: none;
    }

    .editor.mobile .editor-aside {
        flex: 1 !important;
    }

    .editor.mobile .editor-html .extra-area {
        display: none;
    }

    .alternator {
        display: none;
    }

    .editor.mobile .alternator {
        text-align: center;
        display: block;
    }

    .editor.mobile .alternator>button {
        height: 28px;
        border: 1px solid var(--color-border);
        background-color: var(--color-bg);
        margin: 5px 8px;
        border-radius: 5px;
        color: var(--color-text);
        max-width: 100px;
        padding: 0 5%;
    }

    .editor.mobile .alternator>button:first-child {
        display: none;
    }

    .editor.mobile.show-result .editor-result {
        display: flex;
    }

    .editor.mobile.show-result .editor-html {
        display: none;
    }

    .editor.expanded {
        height: auto;
    }

    .editor.expanded .main {
        flex-flow: column;
    }

    .active-side {
        border-color: var(--note-green) !important;
    }
</style>
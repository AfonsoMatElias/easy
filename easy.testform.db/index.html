<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" type="text/css" href="styles.css" />
    <title>Easy library Test form</title>
</head>

<body>

    <div id="main-div-container">

        <div class="modal-control">
            <div><label>Product</label></div>
            <div><select ><!-- Isto é simplesmente demonstrar como funcionam na tag 'select' -->
                <option e-tmp="Product" value="-e-Id-">-e-Name-</option>
            </select></div>
        </div>
        
        <div class="modal-control">
            <br>
            <div><label><b>Id</b> of the element t be updated </label></div>
            <div><input type="text" id="ElemId" placeholder="Id" /></div>
        </div>

        <form id="medicine-form" >
            <div class="modal-control">
                <div>
                    <h4>Test Form</h4>
                </div>
            </div>

            <div class="modal-control">
                <div><label>Name</label></div>
                <div><input type="text" name="Name" placeholder="Car" /></div>
            </div>

            <div class="modal-control">
                <div><label>Price</label></div>
                <div><input type="number" name="Price" placeholder="150" /></div>
            </div>

            <div class="modal-control">
                <div><label>Stock</label></div>
                <div><input type="number" name="Stock" placeholder="10" /></div>
            </div>

            <div class="modal-control">
                <div><label>Description</label></div>
                <div>
                    <textarea name="Description" placeholder="Description" rows="4"></textarea>
                </div>
            </div>
            <div class="modal-control">
                <div><label>Aditionals</label></div>
                <div>
                    <textarea name="Aditionals" placeholder="Adicionais" rows="2"></textarea>
                </div>
            </div>

            <div class="modal-control">
                <div><label>Cor</label></div>
                <div><input name="Color" placeholder="Red" /></div>
            </div>
            <br>
            <div><h3>Category</h3></div>
            <div e-build="Category">
                <div class="modal-control">
                    <div><label>Name</label></div>
                    <div><input name="Name" placeholder="Vehicle" /></div>
                </div>
            </div>

            <div class="modal-control">
                <div class="modal-control-button">
                    <button type="submit" id="save" class="save-medicine">Save</button>
                    <button type="submit" id="update" class="update-medicine">Update</button>
                    <button id="send" class="close-modal" type="button">Cancel</button>
                </div>
            </div>

        </form>
        <br />
        <div class="modal-control">
            <div><input type="text" id="Search" placeholder="Search..." /></div>
        </div>
        <br />
    </div>
    <!-- Single -->
    <div class="prod-list-item" 
         e-fill="Product:P0001" 
         style="border:1px solid -e-Color-">
        <div class="img" style="background-color:-e-Color-">
        </div>
        <div class="text-content">
            <div class="top-text-content">
                <div class="info-m">
                    <div class="info">
                        <b><label>-e-Name-</label></b>
                    </div>
                    <div class="info">
                        <label> -e-Category.Name- </label>
                    </div>
                </div>
                <div class="info-m">
                    <div class="info">
                        <label>Custa -e-Price- $</label>
                    </div>
                    <div class="info">
                        <label> -e-Stock- </label> : <label> -e-Id- </label>
                    </div>
                </div>

            </div>
            <div class="bottom-text-content">
                <div class="info-max">
                    <label> -e-Description- </label>
                </div>
            </div>
        </div>

    </div>
    <!-- List -->
    <div id="prod-list">

        <div class="prod-list-item" 
             e-tmp="Product" 
             e-anm="down"
             e-rvs="true" 
             title="Clique duas vezes para remover o item.">
            <div class="img" e-style="background-color:-e-Color-">
            </div>
            <div class="text-content">
                <div class="top-text-content">
                    
                    <div class="info-m">
                        <div class="info">
                            <b><label>-e-Name-</label></b>
                        </div>
                        <div class="info">
                            <label>-e-Category.Name-</label>
                        </div>
                    </div>
                    <div class="info-m">
                        <div class="info">
                            <label>-e-Price-</label>
                        </div>
                        <div class="info">
                            <label>-e-Stock-</label> : <label>-e-Id-</label>
                        </div>
                    </div>

                </div>
                <div class="bottom-text-content">
                    <div class="info-max">
                        <label>-e-Description-</label>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- Scripts -->
    <script src="../easy.db.js"></script>
    <script src="../easy.js"></script>

    <script>

        /* I took this page and the styles in other project
        reason why you see medicine-form and other stuffs..
        */
       
        // With the 'e' function you can find any element in the DOM even if
        // it was added after the DOM Loaded  

        let rootTable = 'Product';
        
        // Preventing the default form action
        e('#medicine-form', 'submit', function (e) {
            e.preventDefault();
        });

        // Save buttom
        e('#save','click', async function (e) {
            console.log(await easy.create(rootTable, '#medicine-form', true));
            console.log('Created, list: ', await easy.read(rootTable));
        });

        // Update buttom
        e('#update','click', async function (e) {
            e.preventDefault();
            var id = document.getElementById('ElemId').value;
            console.log(await easy.update(rootTable, '#medicine-form', id));
            console.log('Updated, list: ', await easy.read(rootTable));
        });

        // Remove elem event
        e('.prod-list-item', 'dblclick', async function (e, el) {
            let res = await easy.delete(rootTable, el.getAttribute('e-key'));
            console.log('Removed', res, 'list: ', await easy.read(rootTable));
        });

        let cnt = e_sltr('#prod-list');
        document.getElementById('Search').fullTyping(function (el) {
            cnt.innerHTML = '';
            easy.read(rootTable, function (e) {
                easy.addHtml('#prod-list', e);
            }, null, el.value);
        });

    </script>
    
</body>

</html>